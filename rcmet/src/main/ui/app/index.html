<!--
 ~ Licensed to the Apache Software Foundation (ASF) under one
 ~ or more contributor license agreements.  See the NOTICE file
 ~ distributed with this work for additional information
 ~ regarding copyright ownership.  The ASF licenses this file
 ~ to you under the Apache License, Version 2.0 (the
 ~ "License"); you may not use this file except in compliance
 ~ with the License.  You may obtain a copy of the License at
 ~
 ~    http://www.apache.org/licenses/LICENSE-2.0
 ~
 ~ Unless required by applicable law or agreed to in writing,
 ~ software distributed under the License is distributed on an
 ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 ~ KIND, either express or implied.  See the License for the
 ~ specific language governing permissions and limitations
 ~ under the License.
 -->

<!doctype html>
<html lang="en" ng-app="ocw">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OCW UI</title>
  <link rel="stylesheet" href="css/lib/bootstrap.min.css"/>
  <link rel="stylesheet" href="css/lib/bootstrap-responsive.min.css"/>
  <link rel="stylesheet" href="css/lib/font-awesome.min.css"/>
  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.css" />
  <link rel="stylesheet" href="css/lib/timeline.css"/>
  <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/themes/ui-lightness/jquery-ui.min.css" type="text/css"/> 
  <!--[if lte IE 8]>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.5/leaflet.ie.css" />
  <![endif]-->
  <link rel="stylesheet" href="css/app.css"/>
</head>
<body ng-cloak>
  <bootstrap-modal modal-id="datasetSelect">
	<div class="modal-header">
		<button class="close">&times;</button>
		<h3>Dataset Select</h3>
	</div>
	<div class="modal-body">
		<div ng-view></div>
	</div>
	<div class="modal-footer">
		<a href="#" class="btn btn-primary close">Close</a>
	</div>
  </bootstrap-modal>

  <bootstrap-modal modal-id="evaluationSettings">
  <div class="modal-header">
  	<button class="close">&times;</button>
  	<h3>Settings</h3>
  </div>
  <div class="modal-body" ng-controller="SettingsCtrl">
    <h4>Select the metrics you would like to run.</h4>
    <div ng-repeat="metric in settings.metrics">
      <label><input type="checkbox" ng-model="metric.select"> {{metric.name}}</label>
    </div>
    <hr />
    <h4>Select how you would like to temporally re-grid the datasets.</h4>
    <select ng-model="settings.temporal.selected" ng-options="opt for opt in settings.temporal.options"></select>
  </div>
  <div class="modal-footer">
	  <a href="#" class="btn btn-primary close">Close</a>
  </div>
  </bootstrap-modal>

<div class="container-fluid">
  <div class="row-fluid">
    <div class="span12">
    <div class="row-fluid">
      <div class="span12 text-center">
        <h2>Apache Open Climate Workbench UI</h2>
      </div>
    </div>
    <div class="row-fluid">
      <hr />
    </div>
    <div class="row-fluid">
      <div class="span12">
        <div class="row-fluid">
          <div class="span6">
            <!--Dataset Select Controls-->
            <div ng-controller="DatasetSelectCtrl">
              <div class="row-fluid">
                <div class="span1 offset10">
                  <button class="btn btn-link no-color-link" ng-click="clearDatasets()" ng-disabled="shouldDisableClearButton()">
                    <span tooltip-placement="left" tooltip-popup-delay="700" tooltip="Clear Datasets">
                      <i class="icon-trash icon-2x"></i>
                    </span>
                  </button>
                </div>
                <div class="span1">
                  <button class="btn btn-link no-color-link" bootstrap-modal-open="datasetSelect">
                    <span tooltip-placement="left" tooltip-popup-delay="700" tooltip="Add Dataset">
                      <i class="icon-plus icon-2x"></i>
                    </span>
                  </button>
                </div>
              </div>
              <div class="row-fluid">
                <div class="span12">
                  <hr />
                </div>
              </div>
            </div>
            <!--Dataset display-->
            <div ng-controller="DatasetDisplayCtrl" id="datasetDiv">
              <div ng-repeat="dataset in datasets">
                <div class="row-fluid">
                  <!--Data section-->
                  <div class="span8 muted">
                    {{dataset.name}}
                  </div>
                  <div class="span1 offset1">
                    <span tooltip-placement="left" tooltip-popup-delay="700" tooltip="Remove Dataset">  
                      <a class="no-color-link" href="#" ng-click="removeDataset($index)">
                        <i class="icon-remove"></i>
                      </a>
                    </span>
                  </div>
                </div>
                <!--Time Values!-->
                <div class="row-fluid">
                  <!--Dataset Info Section-->
                  <div class="span9">
                    <div class="row-fluid">
                      <div class="span2 text-center">Start Date:</div>
                      <div class="span2">
                        <div class="span2 text-center">{{dataset.timeVals.start | ISODateToMiddleEndian}}</div>
                      </div>
                      <div class="span2 text-center">End Date:</div>
                      <div class="span2">
                        <div class="span2 text-center">{{dataset.timeVals.end | ISODateToMiddleEndian}}</div>
                      </div>
                      <div class="span2">
                        <div class="colorSquare" style="background-color: {{fillColors[$index]}};"></div>
                      </div>
                    </div>
                    <!--Lat/Long Values!-->
                    <div class="row-fluid">
                      <div class="span2 text-center">North:</div>
                      <div class="span2 text-center">
                        {{dataset.latlonVals.latMax}}
                      </div>
                      <div class="span2 text-center">East:</div>
                      <div class="span2 text-center">
                        {{dataset.latlonVals.lonMax}}
                      </div>
                    </div>
                    <div class="row-fluid">
                      <div class="span2 text-center">South:</div>
                      <div class="span2 text-center">
                        {{dataset.latlonVals.latMin}}
                      </div>
                      <div class="span2 text-center">West:</div>
                      <div class="span2 text-center">
                        {{dataset.latlonVals.lonMin}}
                      </div>
                      <div class="span2">
                        <label>
                          <input type="checkbox" ng-model="dataset.regrid" ng-click="setRegridBase($index)"/> 
                          Regrid 
                        </label>
                      </div>
                    </div>
                  </div>
                  <!--Preview Map Section-->
                  <div class="span3">
                    <!--If the dataset is global we show a picture of a globe instead of the actual map-->
                    <div ng-hide="dataset.latlonVals.lonMin == -180 && dataset.latlonVals.lonMax == 180 && 
                                  dataset.latlonVals.latMin == -90 && dataset.latlonVals.latMax == 90" 
                                  preview-map="dataset" index="$index"></div>
                    <div ng-show="dataset.latlonVals.lonMin == -180 && dataset.latlonVals.lonMax == 180 &&
                                  dataset.latlonVals.latMin == -90 && dataset.latlonVals.latMax == 90">
                      <img src="img/globe.png" class="preview-map">
                    </div>
                  </div>
                </div>
                <div class="row-fluid">
                  <div class="span6 offset3"><hr /></div>
                </div>
              </div>
            </div>
        </div>
        <div class="span6">
          <!--Map-->
          <div class="row-fluid"  ng-controller="WorldMapCtrl">
            <div class="span12">
              <leaflet-map id="map"></leaflet-map>
            </div>
          </div>
          
          <!--Timeline-->
          <div class="row-fluid">
            <div class="span12" ng-controller="TimelineCtrl">
              <div class="timeline"></div>
            </div>
          </div>
          
          <div class="row-fluid">
            <div class="span12" ng-controller="ParameterSelectCtrl">
              <div class="row-fluid">
                <div class="span2 text-center">Start Date:</div>
                <div class="span4">
                  <form>
                    <!--This styling HAD to be done inline. Using a class wouldn't work and for some -->
                    <!--reason the input boxes refused to be 100% wide when their span size was set.-->
                    <input ng-disabled="shouldDisableControls()" on-blur="checkParameters();" ng-model="displayParams.start" ui-date="datepickerSettings" ui-date-format="yy-mm-dd" type="text" class="text-center span4" style="width:100%" />
                  </form>
                </div>
                <div class="span2 text-center">End Date:</div>
                <div class="span4">
                  <form>
                    <!--This styling HAD to be done inline. Using a class wouldn't work and for some -->
                    <!--reason the input boxes refused to be 100% wide when their span size was set.-->
                    <input ng-disabled="shouldDisableControls()" on-blur="checkParameters();" ng-model="displayParams.end" ui-date="datepickerSettings" ui-date-format="yy-mm-dd" type="text" class="text-center span4" style="width:100%"/>
                  </form>
                </div>
              </div>
              <div class="row-fluid">
                <div class="span2 text-center">North:</div>
                <div class="span4">
                  <form action="">
                    <input ng-disabled="shouldDisableControls()" ng-model="displayParams.latMax"  on-blur="checkParameters();" type="text" class="span4 text-center" style="width:100%"/>
                  </form>
                </div>
                <div class="span2 text-center">South:</div>
                <div class="span4">
                  <form action="">
                    <!--This styling HAD to be done inline. Using a class wouldn't work and for some -->
                    <!--reason the input boxes refused to be 100% wide when their span size was set.-->
                    <input ng-disabled="shouldDisableControls()" ng-model="displayParams.latMin" on-blur="checkParameters();" type="text" class="span4 text-center" style="width:100%"/>
                  </form>
                </div>
              </div>
              <div class="row-fluid">
                <div class="span2 text-center">East:</div>
                <div class="span4">
                  <form>
                    <!--This styling HAD to be done inline. Using a class wouldn't work and for some -->
                    <!--reason the input boxes refused to be 100% wide when their span size was set.-->
                    <input ng-disabled="shouldDisableControls()" ng-model="displayParams.lonMax" on-blur="checkParameters();" type="text" class="span4 text-center" style="width:100%"/>
                  </form>
                </div>
                <div class="span2 text-center">West:</div>
                <div class="span4">
                  <form>
                    <!--This styling HAD to be done inline. Using a class wouldn't work and for some -->
                    <!--reason the input boxes refused to be 100% wide when their span size was set.-->
                    <input ng-disabled="shouldDisableControls()" ng-model="displayParams.lonMin" on-blur="checkParameters();"; type="text" class="span4 text-center" style="width:100%"/>
                  </form>
                </div>
              </div>
              <div class="row-fluid">
                <div class="span2 offset6">
                  <button class="btn btn-link no-color-link pull-right" bootstrap-modal-open="evaluationSettings">
                    <span tooltip-placement="left" tooltip-popup-delay="700" tooltip="Settings">
                      <span class="icon-stack">
                        <i class="icon-check-empty icon-stack-base"></i>
                        <i class="icon-cogs"></i>
                      </span>
                    </span>
                  </button>
                </div>
                <div class="span4">
                  <button ng-click="runEvaluation()" ng-disabled="shouldDisableEvaluateButton()" class="btn btn-block btn-primary">
                    <div ng-hide="runningEval">Evaluate</div>
                    <div ng-show="runningEval"><i class="icon-spinner icon-spin"></i></div>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <!--Libraries-->
  <script src="js/lib/jquery/jquery-1.10.1.js"></script>
  <script src="js/lib/jquery/jquery-ui/jquery-ui-1.10.3.min.js"></script>
  <script src="js/lib/angular/angular.min.js"></script>
  <script src="js/lib/angular-ui/angular-ui-0.4-tpls.js"></script>
  <script src="js/lib/jquery/jquery-ui/datepicker-wrapper/date.js"></script>
  <script src="js/lib/bootstrap/bootstrap.js"></script>
  <script src="js/lib/leaflet/leaflet-0.5.js"></script>
  <script src="http://www.google.com/jsapi"></script>
  <script src="js/lib/timeline/timeline.js"></script>
  <!--Timeline refuses to initialize nicely so we're doing this as a workaround-->
  <script type="text/javascript">google.load("visualization", "1");</script>
  
  <!--General-->
  <script src="js/app.js"></script>

  <!--Services-->
  <script src="js/services/SelectedDatasetInformation.js"></script>
  <script src="js/services/RegionSelectParams.js"></script>
  <script src="js/services/EvaluationSettings.js"></script>

  <!--Controllers-->
  <script src="js/controllers/WorldMapCtrl.js"></script>
  <script src="js/controllers/ParameterSelectCtrl.js"></script>
  <script src="js/controllers/DatasetDisplayCtrl.js"></script>
  <script src="js/controllers/ObservationSelectCtrl.js"></script>
  <script src="js/controllers/RcmedSelectionCtrl.js"></script>
  <script src="js/controllers/SettingsCtrl.js"></script>
  <script src="js/controllers/TimelineCtrl.js"></script>
  <script src="js/controllers/DatasetSelectCtrl.js"></script>

  <!--Directives-->
  <script src="js/directives/LeafletMap.js"></script>
  <script src="js/directives/PreviewMap.js"></script>
  <script src="js/directives/BootstrapModal.js"></script>
  <script src="js/directives/BootstrapModalOpen.js"></script>
  <script src="js/directives/PredictiveFileBrowserInput.js"></script>
  <script src="js/directives/OnBlur.js"></script>
  <script src="js/directives/Timeline.js"></script>

  <!--Filters-->
  <script src="js/filters/ISODateToMiddleEndian.js"></script>
</body>
</html>
